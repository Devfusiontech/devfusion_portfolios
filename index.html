<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Salma Razzaq — Senior Python/Django Engineer</title>
  <meta name="description" content="Senior Python/Django engineer — building scalable backends, APIs, and data-heavy systems. Portfolio with projects, timeline, GitHub integration, and AI chat." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
   <!-- Favicon Setup (Corrected & Optimized) -->
  <link rel="icon" href="white_monogram.png" type="image/x-icon"> <!-- Standard .ico fallback -->
  <link rel="icon" href="white_monogram.png" type="image/svg+xml"> <!-- Recommended scalable version -->
  <link rel="apple-touch-icon" href="white_monogram.png"> <!-- For iOS devices (180×180px) -->

  <!-- GSAP + ScrollTrigger -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <!-- Lottie for micro-animations -->
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    /* ---------------- Theme tokens (light-first) ---------------- */
    :root{
      --bg: #f4f7fb;
      --surface: #ffffff;
      --muted: #6b7386;
      --text: #0e1220;
      --accent: #0f62fe;     /* indigo-blue */
      --accent-2: #06b6a4;   /* teal */
      --danger: #ff6b6b;
      --border: #e6edf7;
      --shadow: 0 12px 30px rgba(18,24,40,0.06);
      --radius: 14px;
      --glass: rgba(255,255,255,0.6);
      --trans: all .28s cubic-bezier(.2,.9,.2,1);
      --sidebar-width: 300px;
      --mono: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    [data-theme="dark"]{
      --bg: #0b1020;
      --surface: #0f1724;
      --muted: #98a0b6;
      --text: #e6eef8;
      --accent: #7c9cff;
      --accent-2: #2ed3b6;
      --border: #1c2331;
      --shadow: 0 14px 40px rgba(0,0,0,0.6);
      --glass: rgba(255,255,255,0.02);
    }

    /* ---------------- Base layout ---------------- */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--mono);
      background:linear-gradient(180deg, var(--bg), color-mix(in srgb, var(--bg) 90%, #fff 10%));
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      line-height:1.5;
      overflow:hidden;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{opacity:.9}
    img{max-width:100%; display:block}

    /* ---------------- App wrapper ---------------- */
    .app{
      display:flex; height:100vh; width:100vw; gap:20px; padding:20px;
      align-items:stretch;
    }

    /* ---------------- Sidebar ---------------- */
    .sidebar{
      width:var(--sidebar-width);
      min-width:240px;
      background:linear-gradient(180deg, color-mix(in srgb, var(--surface) 96%, var(--bg) 4%), var(--surface));
      border:1px solid var(--border);
      border-radius:16px;
      padding:18px;
      box-shadow:var(--shadow);
      display:flex; flex-direction:column; gap:14px;
      transition:var(--trans);
      overflow:auto;
    }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .avatar{
      width:64px; height:64px; border-radius:12px; object-fit:cover; border:2px solid var(--border);
    }
    .brand h1{font-size:16px; margin:0; font-weight:700}
    .brand p{margin:0; color:var(--muted); font-size:13px}
    .meta-chips{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px}
    .chip{background:var(--glass); padding:6px 8px; border-radius:999px; font-size:12px; color:var(--muted); border:1px solid var(--border)}

    .nav{
      margin-top:6px; display:flex; flex-direction:column; gap:6px;
    }
    .nav button{
      display:flex; gap:12px; align-items:center; border-radius:10px; padding:10px; background:transparent; border:1px solid transparent; text-align:left; cursor:pointer; transition:var(--trans); color:var(--muted);
      font-weight:600;
    }
    .nav button svg, .nav button i{width:18px; text-align:center}
    .nav button.active{background:linear-gradient(90deg,var(--accent) 0%, color-mix(in srgb,var(--accent-2) 40%, var(--accent) 60%)); color:white; box-shadow:0 8px 28px rgba(16,24,56,0.12)}
    .nav button:hover{transform:translateY(-3px)}

    .sidebar-footer{margin-top:auto; display:flex; gap:10px; align-items:center; justify-content:space-between; font-size:13px; color:var(--muted)}
    .theme-toggle{display:flex; gap:8px; align-items:center}

    /* ---------------- Main content ---------------- */
    .main{
      flex:1; height:100%; overflow:auto; padding:22px;
      display:grid; grid-template-columns:1fr; align-items:start; gap:18px;
    }

    .card{
      background:var(--surface); border-radius:14px; padding:18px; border:1px solid var(--border);
      box-shadow:var(--shadow);
      transition:var(--trans);
    }

    /* hero */
    .hero{
      display:grid; grid-template-columns: 1fr 360px; gap:20px; align-items:center;
    }
    .hero-left h2{margin:0; font-size:28px}
    .hero-left p{margin:8px 0 0; color:var(--muted)}
    .hero-cta{display:flex; gap:10px; margin-top:12px}
    .btn{
      border:0; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700; transition:var(--trans);
      background:transparent; border:1px solid var(--border)
    }
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#fff; border-color:transparent}
    .mini-stats{display:flex; gap:12px; margin-top:12px}
    .stat{background:color-mix(in srgb,var(--accent) 6%, transparent); padding:10px; border-radius:12px; min-width:120px; text-align:center}

    .hero-right{display:flex; flex-direction:column; gap:10px; align-items:center}
    .lottie-wrap{width:220px; height:220px; display:flex; align-items:center; justify-content:center}

    /* projects grid */
    .projects-grid{display:grid; grid-template-columns:repeat(auto-fill, minmax(260px,1fr)); gap:14px}
    .project-card{display:flex; flex-direction:column; gap:8px}
    .project-thumb{height:140px; border-radius:10px; overflow:hidden; border:1px solid var(--border); object-fit:cover}
    .project-body{display:flex; flex-direction:column; gap:6px}

    /* timeline */
    .timeline{display:flex; flex-direction:column; gap:12px}
    .tl-item{padding:12px; border-radius:10px; border:1px solid var(--border); background:linear-gradient(180deg,var(--surface), color-mix(in srgb,var(--surface) 96%, #fff 4%))}
    .tl-meta{color:var(--muted); font-size:13px}

    /* skills radar container */
    .skills-wrap{display:flex; gap:20px; align-items:center; flex-wrap:wrap}

    /* contact */
    form .field{display:flex; flex-direction:column; gap:6px}
    input[type="text"], input[type="email"], textarea{padding:10px; border-radius:8px; border:1px solid var(--border); background:transparent; color:var(--text)}
    textarea{min-height:120px; resize:vertical}

    /* chat widget (improved) */
    .chat-widget{
      position:fixed; right:26px; bottom:26px; width:420px; max-width:90vw; z-index:9999; border-radius:12px; overflow:hidden; border:1px solid var(--border); background:var(--surface); box-shadow:0 30px 80px rgba(6,10,30,0.18); transform:translateY(0);
      transition:transform .28s;
    }
    .chat-header{display:flex; align-items:center; gap:10px; padding:12px; border-bottom:1px solid var(--border)}
    .chat-body{max-height:360px; overflow:auto; padding:12px; display:flex; flex-direction:column; gap:8px}
    .chat-input{display:flex; gap:8px; padding:12px; border-top:1px solid var(--border)}
    .msg{padding:8px 10px; border-radius:10px; max-width:82%; display:inline-block}
    .msg.user{background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:white; align-self:flex-end}
    .msg.assistant{background:var(--surface); border:1px solid var(--border); color:var(--text)}

    /* responsive */
    @media (max-width: 980px){
      .app{padding:12px}
      .hero{grid-template-columns:1fr}
      .sidebar{display:none}
      .main{padding:8px}
    }

    /* small helpers */
    .muted{color:var(--muted)}
    .flex{display:flex}
    .space{justify-content:space-between}
    .center{align-items:center; display:flex}
  </style>
</head>
<body>
  <div class="app" id="app">

    <!-- SIDEBAR -->
    <aside class="sidebar" role="navigation" aria-label="Main navigation">
      <div class="brand">
        <img class="avatar" src="salmapf.jpeg" alt="Salma avatar">
        <div>
          <h1>Salma Razzaq</h1>
          <p class="muted"> Python / Django Engineer/ Web Developer</p>
          <div class="meta-chips">
            <span class="chip"><i class="fa-solid fa-briefcase"></i> 2 yrs</span>
            <span class="chip"><i class="fa-solid fa-globe"></i> Remote</span>
          </div>
        </div>
      </div>

      <nav class="nav" aria-label="Primary">
        <button class="nav-btn active" data-target="home"><i class="fa-solid fa-house"></i> Overview</button>
        <button class="nav-btn" data-target="projects"><i class="fa-solid fa-diagram-project"></i> Projects</button>
        <button class="nav-btn" data-target="experience"><i class="fa-solid fa-briefcase"></i> Experience</button>
        <button class="nav-btn" data-target="skills"><i class="fa-solid fa-chart-pie"></i> Skills</button>
        <button class="nav-btn" data-target="notes"><i class="fa-solid fa-feather"></i> Posts / Notes</button>
        <button class="nav-btn" data-target="contact"><i class="fa-solid fa-envelope"></i> Contact</button>
      </nav>

      <div style="margin-top:8px">
        <div class="chip" style="display:flex; gap:8px; align-items:center; justify-content:space-between">
          <div style="display:flex; gap:8px; align-items:center">
            <i class="fa-brands fa-github"></i> <small class="muted">github</small>
          </div>
          <a id="githubProfile" class="muted" href="https://github.com/salmarazzaq257" target="_blank"><i class="fa-solid fa-arrow-up-right-from-square"></i></a>
        </div>
      </div>

      <div class="sidebar-footer">
        <div class="theme-toggle">
          <button id="toggleThemeBtn" class="btn" title="Toggle theme"><i class="fa-solid fa-moon"></i></button>
          <button id="accentBtn" class="btn" title="Pick accent"><i class="fa-solid fa-palette"></i></button>
        </div>
        <div style="display:flex; gap:8px; align-items:center">
          <a class="btn" href="https://www.linkedin.com/in/salma-razzaq/" target="_blank" title="LinkedIn"><i class="fa-brands fa-linkedin"></i></a>
          <a class="btn" href="mailto:salmarazzaq257@gmail.com" title="Email"><i class="fa-solid fa-envelope"></i></a>
        </div>
      </div>

      <!-- Accent popover -->
      <div id="accentPopover" style="display:none; margin-top:10px; gap:8px">
        <div style="display:flex; gap:8px">
          <button class="accent-swatch" data-accent="#0f62fe" style="background:#0f62fe; width:28px; height:28px; border-radius:8px; border:none"></button>
          <button class="accent-swatch" data-accent="#06b6a4" style="background:#06b6a4; width:28px; height:28px; border-radius:8px; border:none"></button>
          <button class="accent-swatch" data-accent="#7c9cff" style="background:#7c9cff; width:28px; height:28px; border-radius:8px; border:none"></button>
          <button class="accent-swatch" data-accent="#d946ef" style="background:#d946ef; width:28px; height:28px; border-radius:8px; border:none"></button>
        </div>
      </div>

    </aside>

    <!-- MAIN -->
    <main class="main" id="main">
      <!-- HOME / OVERVIEW -->
      <section id="home" class="panel card" data-panel>
        <div class="hero">
          <div class="hero-left">
            <span class="chip" style="background:color-mix(in srgb,var(--accent) 8%, transparent); color:var(--accent)">Python / Django Engineer/ Web Developer</span>
            <h2>Building scalable, maintainable backend systems & APIs.</h2>
            <p class="muted">I specialize in Django/DRF, PostgreSQL, event-driven architectures, high-throughput APIs. I focus on reliability, performance, and developer experience.</p>
            <div class="hero-cta">
              <a class="btn primary" href="https://github.com/salmarazzaq257" target="_blank"><i class="fa-brands fa-github"></i> View GitHub</a>
              <a class="btn" href="https://www.linkedin.com/in/salma-razzaq/" target="_blank"><i class="fa-brands fa-linkedin"></i> LinkedIn</a>
              <button class="btn" id="openChatBtn"><i class="fa-solid fa-robot"></i> Ask (AI)</button>
            </div>

           
          </div>

          <div class="hero-right">
            <div class="lottie-wrap card" style="display:flex; align-items:center; justify-content:center; width:100%">
              <!-- Lottie animation — replace src with your animation -->
              <lottie-player id="heroLottie" src="https://assets10.lottiefiles.com/packages/lf20_h4th9ofg.json" background="transparent" speed="1" loop autoplay style="width:180px; height:180px;"></lottie-player>
            </div>

            <div class="card" style="width:100%">
              <strong>Core Stack</strong>
              <div style="display:flex; gap:8px; margin-top:10px; flex-wrap:wrap">
                <span class="chip">Python</span>
                <span class="chip">Django / DRF</span>
                <span class="chip">JS</span>
                <span class="chip">PostgreSQL</span>
                <span class="chip">MySQL</span>
                <span class="chip">PostMan</span>
                <span class="chip">Swagger</span>
                <span class="chip">Shopify</span>
                <span class="chip">WordPress</span>
                <span class="chip">AWS</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- PROJECTS -->
      <section id="projects" class="panel card" data-panel style="display:none">
        <div style="display:flex; justify-content:space-between; align-items:center">
          <h3 style="margin:0">Featured Projects</h3>
          <div style="display:flex; gap:8px">
            <button class="btn" id="refreshRepos" title="Refresh GitHub">Refresh</button>
            <a class="btn primary" href="https://github.com/salmarazzaq257?tab=repositories" target="_blank">All Repos</a>
          </div>
        </div>

        <div style="margin-top:14px" id="projectsContainer" class="projects-grid">
          <!-- GitHub-driven cards will be injected here -->
          <div class="muted">Loading projects…</div>
        </div>

        <div style="margin-top:14px">
          <h4>Project AI Assistant</h4>
          <p class="muted">Ask the AI assistant for summaries, technologies, or hiring fit for a project — uses your local OpenAI key (kept in browser storage).</p>
          <div style="display:flex; gap:8px; margin-top:8px">
            <input id="projectQuery" class="btn" placeholder="e.g., 'Summarize repo: shopify-integration'">
            <button class="btn primary" id="askProjectBtn">Ask AI</button>
          </div>
        </div>
      </section>

      <!-- EXPERIENCE -->
      <section id="experience" class="panel card" data-panel style="display:none">
        <h3>Experience</h3>
        <div class="timeline" style="margin-top:12px">
          <div class="tl-item">
            <strong> Web Developer · Aetos Technologies</strong>
            <div class="tl-meta">2025 — Present · Onsite</div>
            <div class="muted">Developing custom Odoo websites using
              QWeb Templates, XML controllers, and Python backend logic.
              Built dynamic snippets for drag-and-drop functionality in Odoo’s Website Builder.
              Integrated custom modules to extend Odoo’s native features (e.g., eCommerce, forms, blogs).</div>
          </div>
          <div class="tl-item">
            <strong>Python Developer · ALchemative</strong>
            <div class="tl-meta">2024 — 2025</div>
            <div class="muted">Streamlined onboarding by 35% through backend documentation and reduced integration errors by 75% in collaboration with frontend developers. Enhanced the KELINKY logistics application’s performance by 10% through Python backend development integrated with Shopify.</div>
          </div>
          <div class="tl-item">
            <strong>Software Engineer Intern ·ALchemative</strong>
            <div class="tl-meta">2024 </div>
            <div class="muted">Developed hands-on projects including Store locator application and Unified tracking application.
              Used Django framework as a backend developer, gaining experience with REST framework.
              Conducted thorough testing of Shopify applications to ensure seamless functionality; identified and resolved integration issues for 8 apps, resulting in a 15% improvement in user experience ratings from customer feedback.</div>
          </div>
        </div>
      </section>

      <!-- SKILLS -->
      <section id="skills" class="panel card" data-panel style="display:none">
        <div style="display:flex; gap:20px; align-items:center; flex-wrap:wrap">
          <div style="flex:1; min-width:240px">
            <h3>Skills Snapshot</h3>
            <p class="muted">Technical proficiency and emphasis across stacks & practices.</p>
            <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
              <span class="chip">Testing</span>
              <span class="chip">Performance-first</span>
              <span class="chip">Clean Architecture</span>
              <span class="chip">APIs & Microservices</span>
              <span class="chip">Observability</span>
            </div>
          </div>
          <div style="width:360px; max-width:100%">
            <canvas id="skillsChart" height="240" aria-label="Skills radar chart"></canvas>
          </div>
        </div>
      </section>

      <!-- NOTES / TIPS -->
      <section id="notes" class="panel card" data-panel style="display:none">
        <h3>Posts & Engineering Notes</h3>
        <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(240px,1fr)); gap:12px; margin-top:12px">
          <article class="card">
            <strong>Taming N+1 in DRF</strong>
            <p class="muted" style="margin-top:8px">Strategies: select/prefetch, query optimizations, and API contract design that avoid repeating queries.</p>
            <a class="muted" href="#" aria-label="Read more">Read →</a>
          </article>
          <article class="card">
            <strong>Async tasks: Celery vs RQ</strong>
            <p class="muted" style="margin-top:8px">Comparing tradeoffs, visibility, and deployment complexity for common async workloads.</p>
            <a class="muted" href="#" aria-label="Read more">Read →</a>
          </article>
          <article class="card">
            <strong>Postgres indexes that matter</strong>
            <p class="muted" style="margin-top:8px">Practical index strategies for geospatial search, jsonb, and high-cardinality analytics.</p>
            <a class="muted" href="#" aria-label="Read more">Read →</a>
          </article>
        </div>
      </section>

      <!-- CONTACT -->
      <section id="contact" class="panel card" data-panel style="display:none">
        <h3>Contact</h3>
        <p class="muted">Let’s discuss your roadmap, do an architecture audit, or hire for a short contract.</p>
        <form id="contactForm" style="margin-top:12px; max-width:720px">
          <div class="field"><label class="muted">Name</label><input name="name" type="text" placeholder="Your name" required></div>
          <div class="field" style="margin-top:8px"><label class="muted">Email</label><input name="email" type="email" placeholder="you@example.com" required></div>
          <div class="field" style="margin-top:8px"><label class="muted">Message</label><textarea name="message" placeholder="Project goals, timeline, budget..." required></textarea></div>
          <div style="margin-top:10px; display:flex; gap:8px; align-items:center">
            <button class="btn primary" type="submit"><i class="fa-solid fa-paper-plane"></i> Send</button>
            <div id="formStatus" class="muted"></div>
          </div>
        </form>
      </section>

    </main>
  </div>

  <!-- Chat widget (collapsed by default) -->
  <div id="chat" class="chat-widget" style="display:none">
    <div class="chat-header">
      <div style="display:flex; gap:8px; align-items:center">
        <i class="fa-solid fa-robot"></i>
        <strong>Salma (AI)</strong>
      </div>
      <div style="margin-left:auto; display:flex; gap:8px; align-items:center">
        <input id="openaiKey" placeholder="sk-..." style="padding:6px 8px; border-radius:8px; border:1px solid var(--border); background:transparent; color:var(--text); width:220px;">
        <button class="btn" id="saveKeyBtn" title="Save locally"><i class="fa-solid fa-floppy-disk"></i></button>
        <button class="btn" id="closeChat"><i class="fa-solid fa-xmark"></i></button>
      </div>
    </div>
    <div class="chat-body" id="chatBody" aria-live="polite"></div>
    <div class="chat-input">
      <input id="chatInput" placeholder="Ask about projects, availability, or tech choices..." style="flex:1; padding:8px; border-radius:8px; border:1px solid var(--border); background:transparent;">
      <button class="btn primary" id="sendChat">Send</button>
    </div>
    <div style="padding:8px; border-top:1px solid var(--border); font-size:12px; color:var(--muted)">Tip: store your OpenAI key locally to enable replies. For production keep keys on a server.</div>
  </div>

  <script>
    // ---------------- App Initialization ----------------
    const GITHUB_USER = 'salmarazzaq257';
    const panels = [...document.querySelectorAll('[data-panel]')];
    const navButtons = [...document.querySelectorAll('.nav-btn')];

    // theme handling
    const root = document.documentElement;
    const savedTheme = localStorage.getItem('theme') || 'light';
    if(savedTheme === 'dark') root.setAttribute('data-theme', 'dark');

    // accent handling
    const savedAccent = localStorage.getItem('accent');
    if(savedAccent) {
      root.style.setProperty('--accent', savedAccent);
    }

    // map nav -> panel
    function showPanel(id){
      panels.forEach(p => p.style.display = p.id === id ? '' : 'none');
      navButtons.forEach(b => b.classList.toggle('active', b.dataset.target === id));
      // animate in with GSAP
      const visible = document.getElementById(id);
      gsap.fromTo(visible, {autoAlpha:0, y:10, scale:0.995}, {autoAlpha:1, y:0, scale:1, duration:0.5, ease:'power3.out'});
      // update URL hash (optional)
      history.replaceState(null, '', `#${id}`);
    }

    navButtons.forEach(btn => {
      btn.addEventListener('click', () => showPanel(btn.dataset.target));
    });

    // check hash on load
    const startHash = window.location.hash.replace('#','') || 'home';
    setTimeout(()=> showPanel(startHash), 50);

    // theme toggle
    const toggleThemeBtn = document.getElementById('toggleThemeBtn');
    toggleThemeBtn.addEventListener('click', () => {
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      if(isDark) { document.documentElement.removeAttribute('data-theme'); localStorage.setItem('theme','light'); }
      else { document.documentElement.setAttribute('data-theme','dark'); localStorage.setItem('theme','dark'); }
      // repaint charts if any
      if(window.skillsChart) window.skillsChart.update();
    });

    // accent pick
    document.querySelectorAll('.accent-swatch').forEach(s => {
      s.addEventListener('click', (e) => {
        const c = e.currentTarget.dataset.accent;
        root.style.setProperty('--accent', c);
        localStorage.setItem('accent', c);
      });
    });
    document.getElementById('accentBtn').addEventListener('click', () => {
      const pop = document.getElementById('accentPopover');
      pop.style.display = pop.style.display === 'flex' ? 'none' : 'flex';
    });

    // ---------------- GSAP scroll reveal ----------------
    gsap.registerPlugin(ScrollTrigger);
    gsap.utils.toArray('.card').forEach(card => {
      gsap.from(card, {
        y: 12, autoAlpha: 0, duration: .6, ease: 'power2.out',
        scrollTrigger: { trigger: card, start: 'top 90%' }
      });
    });

    // ---------------- GitHub repos loader ----------------
    const projectsContainer = document.getElementById('projectsContainer');
    async function loadRepos(){
      projectsContainer.innerHTML = '<div class="muted">Loading projects…</div>';
      try{
        const res = await fetch(`https://api.github.com/users/${GITHUB_USER}/repos?per_page=20&sort=updated`);
        if(!res.ok) throw new Error('GitHub API rate limit or network error');
        const repos = await res.json();
        // pick top 6 by stargazers + recent activity
        const top = repos.sort((a,b) => (b.stargazers_count - a.stargazers_count) || (new Date(b.updated_at)-new Date(a.updated_at))).slice(0,8);
        if(top.length === 0) projectsContainer.innerHTML = '<div class="muted">No public repos found.</div>';
        else {
          projectsContainer.innerHTML = '';
          top.forEach(r => {
            const el = document.createElement('article');
            el.className = 'project-card card';
            el.innerHTML = `
              <img class="project-thumb" src="https://opengraph.githubassets.com/1/${GITHUB_USER}/${r.name}" alt="${r.name}">
              <div class="project-body">
                <div style="display:flex; justify-content:space-between; align-items:center">
                  <strong>${r.name}</strong>
                  <div style="display:flex; gap:8px">
                    <span class="muted" title="Stars"><i class="fa-solid fa-star"></i> ${r.stargazers_count}</span>
                    <a class="muted" href="${r.html_url}" target="_blank"><i class="fa-solid fa-arrow-up-right-from-square"></i></a>
                  </div>
                </div>
                <div class="muted" style="font-size:13px; margin-top:6px">${r.description || ''}</div>
                <div style="display:flex; gap:8px; margin-top:8px">
                  <span class="chip">${r.language || '—'}</span>
                  <span class="chip">${(new Date(r.updated_at)).getFullYear()}</span>
                </div>
              </div>
            `;
            projectsContainer.appendChild(el);
          });
        }
      } catch(err){
        projectsContainer.innerHTML = `<div class="muted">Error loading repos: ${err.message}</div>`;
        console.error(err);
      }
    }
    document.getElementById('refreshRepos').addEventListener('click', loadRepos);
    loadRepos();

    // ---------------- Project AI assistant (simple wrapper) ----------------
    const askProjectBtn = document.getElementById('askProjectBtn');
    const projectQuery = document.getElementById('projectQuery');
    async function sendOpenAI(prompt){
      const key = localStorage.getItem('openai_key') || document.getElementById('openaiKey').value.trim();
      if(!key) return renderChatAssistant('Please add an OpenAI API key in the chat header or save it.');
      renderChatUser(prompt);
      renderChatAssistant('Thinking…');
      try{
        const res = await fetch('https://api.openai.com/v1/chat/completions', {
          method:'POST',
          headers:{ 'Content-Type': 'application/json', 'Authorization': `Bearer ${key}` },
          body: JSON.stringify({
            model: 'gpt-4o-mini',
            messages: [{role:'system', content:'You are a concise assistant summarizing GitHub projects and recommending hiring fit.'}, {role:'user', content: prompt}],
            temperature: 0.2
          })
        });
        const data = await res.json();
        const text = data?.choices?.[0]?.message?.content || JSON.stringify(data);
        // remove last assistant "thinking…"
        const lastAssistant = Array.from(document.querySelectorAll('.msg.assistant')).pop();
        if(lastAssistant) lastAssistant.remove();
        renderChatAssistant(text);
      } catch(err){
        const lastAssistant = Array.from(document.querySelectorAll('.msg.assistant')).pop();
        if(lastAssistant) lastAssistant.remove();
        renderChatAssistant('API error. Check your key or network. For production route requests through your server.');
        console.error(err);
      }
    }

    askProjectBtn.addEventListener('click', () => {
      const q = (projectQuery.value || '').trim();
      if(!q) return alert('Type a question like: "Summarize repo: shopify-integration"');
      sendOpenAI(q);
      // auto-open chat
      openChat();
    });

    // ---------------- Chat widget behavior ----------------
    const chatEl = document.getElementById('chat');
    const openChatBtn = document.getElementById('openChatBtn');
    const closeChat = document.getElementById('closeChat');
    const chatBody = document.getElementById('chatBody');
    const sendChatBtn = document.getElementById('sendChat');
    const chatInput = document.getElementById('chatInput');
    const openaiKeyInput = document.getElementById('openaiKey');
    const saveKeyBtn = document.getElementById('saveKeyBtn');

    function renderChatUser(text){
      const d = document.createElement('div');
      d.style.display='flex'; d.style.justifyContent='flex-end';
      d.innerHTML = `<div class="msg user">${escapeHtml(text)}</div>`;
      chatBody.appendChild(d); chatBody.scrollTop = chatBody.scrollHeight;
    }
    function renderChatAssistant(text){
      const d = document.createElement('div');
      d.style.display='flex'; d.style.justifyContent='flex-start';
      d.innerHTML = `<div class="msg assistant">${escapeHtml(text)}</div>`;
      chatBody.appendChild(d); chatBody.scrollTop = chatBody.scrollHeight;
    }

    function escapeHtml(s){
      return s ? s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('\n','<br/>') : '';
    }

    function openChat(){
      chatEl.style.display='block';
      gsap.fromTo(chatEl, {y:40, autoAlpha:0}, {y:0, autoAlpha:1, duration:0.4, ease:'power3.out'});
    }
    function closeChatFn(){
      gsap.to(chatEl, {y:30, autoAlpha:0, duration:0.3, onComplete:()=> chatEl.style.display='none'});
    }

    openChatBtn.addEventListener('click', openChat);
    closeChat.addEventListener('click', closeChatFn);

    // store/save key locally
    saveKeyBtn.addEventListener('click', () => {
      const key = openaiKeyInput.value.trim();
      if(!key) return alert('Enter your OpenAI key starting with sk-');
      if(!/^sk-/.test(key)) return alert('This does not look like a valid OpenAI key.');
      localStorage.setItem('openai_key', key);
      alert('Saved locally. For production keep keys on a secure server.');
    });

    // send chat
    sendChatBtn.addEventListener('click', async () => {
      const text = chatInput.value.trim();
      if(!text) return;
      const key = localStorage.getItem('openai_key') || openaiKeyInput.value.trim();
      if(!key) { renderChatAssistant('No API key found. Add one in the header or save it.'); return; }
      renderChatUser(text); chatInput.value='';
      renderChatAssistant('Thinking…');
      try{
        const res = await fetch('https://api.openai.com/v1/chat/completions', {
          method:'POST',
          headers:{ 'Content-Type': 'application/json', 'Authorization': `Bearer ${key}` },
          body: JSON.stringify({
            model: 'gpt-4o-mini',
            messages: [{role:'system', content:'You are Salma’s portfolio assistant. Respond concisely about projects, experience, and availability.'}, {role:'user', content: text}],
            temperature: 0.2
          })
        });
        const data = await res.json();
        const textResp = data?.choices?.[0]?.message?.content || 'No response.';
        // remove last assistant "Thinking…"
        const lastAssistant = Array.from(document.querySelectorAll('.msg.assistant')).pop();
        if(lastAssistant) lastAssistant.remove();
        renderChatAssistant(textResp);
      } catch(err){
        const lastAssistant = Array.from(document.querySelectorAll('.msg.assistant')).pop();
        if(lastAssistant) lastAssistant.remove();
        renderChatAssistant('API error. For production route requests through your backend.');
        console.error(err);
      }
    });

    chatInput.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendChatBtn.click(); }
    });

    // preload saved key into header input
    openaiKeyInput.value = localStorage.getItem('openai_key') || '';

    // ---------------- Contact form (client-side) ----------------
    document.getElementById('contactForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const fd = new FormData(e.target);
      const name = fd.get('name')?.trim(), email = fd.get('email')?.trim(), msg = fd.get('message')?.trim();
      const status = document.getElementById('formStatus');
      if(!name || !email || !msg){ status.textContent = 'Please fill all fields.'; status.style.color = 'var(--danger)'; return; }
      // TODO: send to your backend / email service
      status.textContent = 'Thanks — I will reply shortly.';
      status.style.color = 'var(--accent)';
      e.target.reset();
    });

    // ---------------- Skills Chart ----------------
    const ctx = document.getElementById('skillsChart');
    const skillsData = {
      labels: ['Django/DRF','Python','Postgres','Redis/Celery','Docker','API Design'],
      datasets: [{
        label: 'Proficiency',
        data: [95,93,88,82,80,74],
        fill: true,
        backgroundColor: 'rgba(15,98,254,0.12)',
        borderColor: getComputedStyle(document.documentElement).getPropertyValue('--accent'),
        pointBackgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--accent')
      }]
    };
    window.skillsChart = new Chart(ctx, {
      type: 'radar',
      data: skillsData,
      options: {
        responsive:true,
        plugins:{legend:{display:false}},
        scales: {
          r: {
            pointLabels: { color: getComputedStyle(document.documentElement).getPropertyValue('--muted') },
            grid: { color: getComputedStyle(document.documentElement).getPropertyValue('--border') },
            angleLines: { color: getComputedStyle(document.documentElement).getPropertyValue('--border') },
            suggestedMin: 50, suggestedMax: 100, ticks:{display:false}
          }
        }
      }
    });

    // update chart colors on theme change
    const observer = new MutationObserver(() => {
      if(window.skillsChart){
        const cs = getComputedStyle(document.documentElement);
        window.skillsChart.data.datasets[0].borderColor = cs.getPropertyValue('--accent').trim();
        window.skillsChart.update();
      }
    });
    observer.observe(document.documentElement, { attributes: true, attributeFilter: ['data-theme', 'style'] });

    // ---------------- small utility: animate hero Lottie on theme change ----------------
    const heroLottie = document.getElementById('heroLottie');
    const lottieObserver = new MutationObserver(() => {
      // if you want, you can change speed or swap src based on theme
      if(document.documentElement.getAttribute('data-theme') === 'dark'){
        heroLottie.setAttribute('speed','0.9');
      } else { heroLottie.setAttribute('speed','1'); }
    });
    lottieObserver.observe(document.documentElement, { attributes: true, attributeFilter: ['data-theme'] });

    // Accessibility: keyboard nav for panels
    document.addEventListener('keydown', (e) => {
      if(e.key === 'Tab') return;
    });

    // small polish: reveal initial panel with GSAP
    gsap.from('.panel', {autoAlpha:0, y:10, duration:0.5, stagger:0.06, ease:'power2.out'});

    // expose showPanel for the hash change
    window.showPanel = showPanel;

    // ensure accessible focus when panels change
    navButtons.forEach(b => b.addEventListener('click', () => {
      const target = document.getElementById(b.dataset.target);
      target.setAttribute('tabindex','-1');
      target.focus({preventScroll:false});
    }));

  </script>
</body>
</html>
